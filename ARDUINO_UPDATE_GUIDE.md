# ЁЯФз Arduino Update Guide - On-Demand Data System

## ЁЯУЭ р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕З

### тЬЕ р╕Бр╣Ир╕нр╕Щр╕лр╕Щр╣Йр╕▓ (р╣Др╕бр╣Ир╕Фр╕╡):
```
Arduino тЖТ р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╕ер╕нр╕Фр╣Ар╕зр╕ер╕▓ тЖТ Pi Server тЖТ Firebase
(р╣Ар╕кр╕╡р╕в Firebase calls р╣Бр╕бр╣Йр╣Др╕бр╣Ир╕бр╕╡р╕Др╕Щр╕Фр╕╣)
```

### тЬЕ р╕Хр╕нр╕Щр╕Щр╕╡р╣Й (р╕Фр╕╡р╕Вр╕╢р╣Йр╕Щ):
```
Web App тЖТ р╕Вр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕е тЖТ Pi Server тЖТ Arduino тЖТ р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ъ тЖТ Web App
(р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Йр╕Юр╕▓р╕░р╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Др╕Щр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ)
```

## ЁЯЪА р╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Ф Arduino Code

### 1. р╣Ар╕Ыр╕┤р╕Ф Arduino IDE
### 2. р╣Ар╕Ыр╕┤р╕Фр╣Др╕Яр╕ер╣М `fish-feeder-arduino/src/main.cpp`
### 3. Copy code р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╣Гр╕кр╣Ир╣Др╕Яр╕ер╣М .ino р╣Гр╕лр╕бр╣И
### 4. р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕ер╕З Arduino Mega 2560

## ЁЯУб р╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Гр╕лр╕бр╣Ир╕Чр╕╡р╣Ир╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Вр╣Йр╕▓р╕бр╕▓

### р╕Вр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕е:
- `GET_DATA` тЖТ р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е sensor р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ
- `GET_SENSORS` тЖТ р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е sensor
- `GET_STATUS` тЖТ р╕кр╣Ир╕Зр╕кр╕Цр╕▓р╕Щр╕░р╕гр╕░р╕Ър╕Ъ

### р╕Бр╕▓р╕гр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ъ:
```
р╕кр╣Ир╕З: GET_DATA
р╣Др╕Фр╣Й: [ACK] GET_DATA SENDING_CURRENT_DATA
     [DATA] TEMP1:25.5,HUM1:60,WEIGHT:1.23,...
```

## ЁЯМР API Endpoints р╣Гр╕лр╕бр╣И

### Real-time data (р╕Вр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣Ир╕Ир╕▓р╕Б Arduino):
```
GET /api/sensors
```

### Cached data (р╕Ыр╕гр╕░р╕лр╕вр╕▒р╕Ф Arduino calls):
```
GET /api/sensors/cached
```

### Force sync to Firebase:
```
POST /api/sensors/sync
```

## ЁЯТ░ р╕Ыр╕гр╕░р╣Вр╕вр╕Кр╕Щр╣Мр╕Чр╕╡р╣Ир╣Др╕Фр╣Й

1. **р╕Ыр╕гр╕░р╕лр╕вр╕▒р╕Ф Firebase calls** - р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╣Ар╕Йр╕Юр╕▓р╕░р╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Др╕Щр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
2. **р╕ер╕Ф Arduino workload** - р╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╕ер╕нр╕Фр╣Ар╕зр╕ер╕▓
3. **р╕Ыр╕гр╕░р╕лр╕вр╕▒р╕Фр╣Др╕Я** - Arduino р╕Чр╕│р╕Зр╕▓р╕Щр╕Щр╣Йр╕нр╕вр╕ер╕З
4. **р╕Др╕зр╕Ър╕Др╕╕р╕бр╣Др╕Фр╣Й** - Web App р╕Вр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕бр╕╖р╣Ир╕нр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г

## ЁЯзк р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ

### р╕Чр╕Фр╕кр╕нр╕Ъ Arduino:
```bash
# р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М pi-mqtt-server
python test_arduino_commands.py
```

### р╕Чр╕Фр╕кр╕нр╕Ъ API:
```bash
curl http://localhost:5000/api/sensors
curl http://localhost:5000/api/sensors/cached
```

## тЪая╕П р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕

- Arduino р╕Ир╕░р╕лр╕вр╕╕р╕Фр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
- р╣Гр╕Кр╣Й heartbeat р╣Ар╕Юр╕╖р╣Ир╕нр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н
- Web App р╕Хр╣Йр╕нр╕Зр╕Вр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕нр╕Зр╣Ар╕бр╕╖р╣Ир╕нр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г 