<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>ğŸ”¥ Firebase Connection Test</h1>
    
    <div id="status" class="status info">à¸à¸³à¸¥à¸±à¸‡à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ Firebase...</div>
    
    <div>
        <button onclick="testConnection()">ğŸ” Test Connection</button>
        <button onclick="testLEDOn()">ğŸ’¡ LED ON</button>
        <button onclick="testLEDOff()">ğŸ’¡ LED OFF</button>
        <button onclick="testFanOn()">ğŸŒªï¸ Fan ON</button>
        <button onclick="testFanOff()">ğŸŒªï¸ Fan OFF</button>
    </div>
    
    <h3>ğŸ“Š Firebase Data:</h3>
    <pre id="data">à¸à¸³à¸¥à¸±à¸‡à¹‚à¸«à¸¥à¸”...</pre>
    
    <h3>ğŸ“ Logs:</h3>
    <div id="logs"></div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, set, onValue } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDDJOzZOzNJoWmTNbHVGAL0-5KPQNcr8iY",
            authDomain: "fish-feeder-test-1.firebaseapp.com",
            databaseURL: "https://fish-feeder-test-1-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "fish-feeder-test-1",
            storageBucket: "fish-feeder-test-1.firebasestorage.app",
            messagingSenderId: "965648166404",
            appId: "1:965648166404:web:9a8e0c5c8be5b2e4b5f9e8",
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        function log(message) {
            const logs = document.getElementById('logs');
            const time = new Date().toLocaleTimeString();
            logs.innerHTML += `<div>[${time}] ${message}</div>`;
            logs.scrollTop = logs.scrollHeight;
        }

        function updateStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
        }

        // Listen to Firebase data
        const fishFeederRef = ref(database, 'fish_feeder');
        onValue(fishFeederRef, (snapshot) => {
            const data = snapshot.val();
            if (data) {
                document.getElementById('data').textContent = JSON.stringify(data, null, 2);
                updateStatus('âœ… à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ Firebase à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!', 'success');
                log('ğŸ“¡ à¹„à¸”à¹‰à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸ Firebase');
            } else {
                updateStatus('âš ï¸ à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸™ Firebase', 'error');
                log('âŒ à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸™ Firebase');
            }
        }, (error) => {
            updateStatus('âŒ à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ Firebase à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§: ' + error.message, 'error');
            log('âŒ Firebase Error: ' + error.message);
        });

        // Global functions for buttons
        window.testConnection = function() {
            log('ğŸ” à¸—à¸”à¸ªà¸­à¸šà¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­...');
            updateStatus('ğŸ”„ à¸à¸³à¸¥à¸±à¸‡à¸—à¸”à¸ªà¸­à¸š...', 'info');
        };

        window.testLEDOn = async function() {
            try {
                log('ğŸ’¡ à¸ªà¹ˆà¸‡à¸„à¸³à¸ªà¸±à¹ˆà¸‡ LED ON...');
                await set(ref(database, 'fish_feeder/control/led'), 'on');
                log('âœ… LED ON à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!');
            } catch (error) {
                log('âŒ LED ON à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§: ' + error.message);
            }
        };

        window.testLEDOff = async function() {
            try {
                log('ğŸ’¡ à¸ªà¹ˆà¸‡à¸„à¸³à¸ªà¸±à¹ˆà¸‡ LED OFF...');
                await set(ref(database, 'fish_feeder/control/led'), 'off');
                log('âœ… LED OFF à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!');
            } catch (error) {
                log('âŒ LED OFF à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§: ' + error.message);
            }
        };

        window.testFanOn = async function() {
            try {
                log('ğŸŒªï¸ à¸ªà¹ˆà¸‡à¸„à¸³à¸ªà¸±à¹ˆà¸‡ Fan ON...');
                await set(ref(database, 'fish_feeder/control/fan'), 'on');
                log('âœ… Fan ON à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!');
            } catch (error) {
                log('âŒ Fan ON à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§: ' + error.message);
            }
        };

        window.testFanOff = async function() {
            try {
                log('ğŸŒªï¸ à¸ªà¹ˆà¸‡à¸„à¸³à¸ªà¸±à¹ˆà¸‡ Fan OFF...');
                await set(ref(database, 'fish_feeder/control/fan'), 'off');
                log('âœ… Fan OFF à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!');
            } catch (error) {
                log('âŒ Fan OFF à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§: ' + error.message);
            }
        };

        log('ğŸš€ Firebase Test à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¹à¸¥à¹‰à¸§');
    </script>
</body>
</html> 